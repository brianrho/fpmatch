# Author: Brian Ejike (2019)
# Distributed under the MIT license

from ctypes import *

MATCH_THRESHOLD = 50

# sample 512-byte templates
# 16 and 18 belong to the same finger, 17 is different

template16 = [
        3, 1, 80, 24, 0, 0, 255, 254, 255, 62, 252, 30, 248, 14, 240, 6,
        224, 6, 192, 6, 192, 6, 128, 6, 128, 6, 128, 6, 128, 2, 0, 2,
        0, 6, 128, 6, 128, 6, 128, 14, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 55, 20, 6, 190, 80, 24, 153, 30,
        67, 155, 156, 126, 31, 30, 197, 62, 66, 162, 90, 158, 107, 174, 210, 254,
        72, 177, 22, 190, 58, 66, 22, 62, 50, 36, 27, 127, 91, 176, 148, 63,
        97, 63, 170, 151, 83, 65, 211, 255, 81, 10, 164, 116, 63, 146, 223, 92,
        25, 178, 4, 125, 19, 178, 156, 221, 25, 39, 68, 218, 25, 37, 28, 155,
        31, 194, 195, 251, 17, 62, 221, 150, 74, 18, 108, 247, 29, 63, 69, 209,
        25, 191, 155, 46, 18, 189, 5, 139, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        3, 1, 83, 21, 0, 0, 255, 254, 255, 254, 255, 30, 252, 14, 248, 6,
        240, 2, 224, 2, 224, 2, 192, 2, 192, 2, 192, 2, 128, 2, 128, 2,
        128, 2, 128, 2, 128, 6, 128, 6, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 83, 15, 219, 222, 56, 18, 134, 158,
        82, 151, 216, 254, 71, 155, 27, 254, 33, 30, 4, 254, 69, 33, 26, 94,
        51, 161, 219, 190, 26, 37, 196, 158, 95, 47, 83, 254, 75, 47, 150, 190,
        17, 183, 68, 30, 61, 64, 86, 62, 36, 183, 90, 127, 87, 64, 20, 191,
        22, 49, 27, 21, 28, 177, 3, 221, 65, 14, 134, 54, 20, 61, 156, 150,
        22, 60, 67, 151, 24, 65, 67, 247, 66, 18, 94, 18, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
]

template17 = [
        3, 1, 94, 20, 0, 0, 255, 254, 252, 62, 240, 14, 224, 6, 192, 6,
        192, 6, 192, 2, 128, 2, 128, 2, 128, 0, 128, 0, 128, 0, 128, 0,
        128, 0, 128, 2, 128, 2, 192, 6, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 58, 140, 218, 222, 85, 24, 105, 30,
        52, 25, 218, 94, 87, 166, 211, 62, 108, 171, 146, 30, 61, 171, 216, 62,
        39, 47, 66, 190, 30, 175, 154, 126, 17, 55, 68, 126, 87, 184, 232, 254,
        103, 188, 82, 190, 85, 61, 147, 190, 78, 145, 212, 255, 92, 22, 82, 87,
        26, 157, 131, 119, 79, 31, 212, 223, 75, 37, 169, 191, 111, 62, 17, 223,
        71, 55, 85, 210, 66, 55, 172, 82, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        3, 1, 92, 25, 0, 0, 255, 254, 255, 254, 240, 126, 224, 30, 192, 30,
        128, 30, 0, 14, 0, 6, 0, 6, 0, 6, 0, 6, 0, 6, 0, 6,
        0, 2, 0, 2, 128, 2, 128, 6, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 32, 14, 6, 30, 79, 21, 16, 158,
        60, 24, 85, 126, 89, 152, 79, 126, 37, 32, 219, 30, 12, 161, 196, 222,
        62, 40, 20, 222, 48, 50, 215, 254, 52, 61, 236, 222, 72, 190, 232, 190,
        69, 146, 18, 255, 42, 148, 156, 63, 75, 156, 210, 63, 89, 28, 229, 223,
        65, 159, 104, 95, 61, 172, 105, 31, 72, 172, 147, 63, 95, 176, 209, 95,
        61, 61, 213, 191, 90, 191, 210, 31, 17, 65, 217, 215, 41, 167, 217, 252,
        22, 54, 130, 157, 15, 182, 219, 93, 35, 38, 2, 83, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
]

template18 = [
        3, 1, 86, 22, 0, 0, 255, 254, 254, 62, 252, 30, 240, 6, 224, 6,
        224, 6, 224, 2, 192, 2, 192, 2, 192, 2, 192, 2, 192, 2, 192, 2,
        128, 2, 128, 2, 128, 2, 128, 6, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 64, 140, 225, 126, 55, 22, 134, 222,
        80, 155, 216, 190, 69, 158, 219, 222, 69, 37, 218, 62, 50, 166, 156, 30,
        75, 180, 22, 94, 92, 52, 19, 158, 26, 61, 195, 222, 63, 150, 222, 127,
        33, 161, 69, 95, 23, 181, 219, 247, 38, 56, 131, 95, 39, 188, 218, 191,
        81, 13, 227, 92, 78, 144, 232, 253, 35, 23, 134, 250, 35, 26, 95, 154,
        28, 42, 196, 218, 53, 46, 66, 154, 51, 49, 26, 218, 28, 40, 155, 219,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        3, 1, 82, 21, 0, 0, 255, 254, 252, 254, 240, 30, 224, 14, 192, 14,
        192, 14, 192, 6, 192, 6, 128, 6, 128, 6, 128, 6, 0, 2, 0, 2,
        0, 2, 128, 6, 128, 6, 128, 14, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 65, 153, 24, 62, 55, 156, 219, 158,
        35, 163, 155, 94, 103, 164, 18, 222, 81, 47, 211, 30, 62, 177, 22, 30,
        76, 193, 148, 30, 55, 34, 89, 191, 16, 51, 131, 255, 21, 67, 90, 191,
        41, 21, 198, 60, 47, 20, 94, 189, 37, 46, 154, 58, 36, 172, 66, 91,
        27, 186, 154, 59, 64, 139, 38, 88, 62, 17, 167, 214, 19, 59, 2, 244,
        51, 11, 161, 79, 58, 146, 128, 21, 62, 14, 164, 211, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
]

# load the DLL and call the function, templates must be bytes objects
arth = WinDLL('ARTH_DLL')
score = arth.Match2Fp(bytes(template18), bytes(template16))
print("Match score: {}".format(score))

if score > MATCH_THRESHOLD:
    print('Templates match.')
else:
    print('Templates do not match!')
